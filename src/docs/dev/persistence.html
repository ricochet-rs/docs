<body>
<div class="frontmatter">
<div class="title"><h1>Persistent artifacts</h1></div>
</div>
<div class="body">
<p>It is often desirable to be able to modify files across deployments. To accomplish this, ricochet provides a directory for each content item called <code>persistent</code>. The <code>peristent</code> directory persists across multiple deployments.</p>
<p>For example, you may have a <a href="https://duckdb.org/">DuckDB</a> or <a href="https://www.sqlite.org/">SQLite</a> database that powers your shiny application. If you perform writes to the database and want to persist the storage, it is recommended to store it in <code>persistent</code>.</p>
<h2 id="sec:example-application">Example application</h2>
<p>Below is an example of a Shiny application that utilizes the <code>persistent</code> directory to have shared storage across all instances and deployments of the application.</p>
<pre><code class="language-r">library(shiny)
library(DBI)
library(RSQLite)

db_path &lt;- "persistent/app_data.sqlite3"

# Ensure table exists
con &lt;- dbConnect(SQLite(), db_path)
dbExecute(
  con,
  "
  CREATE TABLE IF NOT EXISTS messages (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    message TEXT,
    submission_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP
  )
"
)

dbDisconnect(con)

ui &lt;- fluidPage(
  textInput("message", NULL, placeholder = "Enter your message"),
  actionButton("submit", "Save Message"),
  tableOutput("data_table")
)

server &lt;- function(input, output, session) {
  refresh &lt;- reactiveVal(FALSE)
  observeEvent(input$submit, {
    if (nzchar(input$message)) {
      con &lt;- dbConnect(SQLite(), db_path)
      dbExecute(
        con,
        "INSERT INTO messages (message) VALUES (?)",
        list(input$message)
      )
      dbDisconnect(con)
      updateTextInput(session, "message", value = "")
      refresh(!refresh())
    }
  })

  df &lt;- reactive({
    # Force reactivity when trigger changes
    refresh()
    con &lt;- dbConnect(RSQLite::SQLite(), db_path)
    data &lt;- dbGetQuery(
      con,
      "SELECT id, message, submission_time FROM messages ORDER BY id DESC"
    )
    dbDisconnect(con)
    data
  })
  output$data_table &lt;- renderTable(df())
}

shinyApp(ui, server)
</code></pre>
</div>
</body>