<body>
<h1 id="chp:quickstart">Quickstart</h1>
<p>This guide is designed to get you deploying to <strong><code>ricochet</code></strong> as quickly as possible.</p>
<p>If you need to install and deploy a ricochet server, head over to the <a href="/install">installation docs</a>.</p>
<h2 id="sec:prerequisites">Prerequisites</h2>
<p>To follow along with this guide ensure that you</p>
<ul>
<li>have a <strong><code>ricochet</code></strong> account with the role of <code>publisher</code> or <code>admin</code>
</li>
<li>have R version 4.2 or greater installed</li>
<li>an active internet connection</li>
</ul>
<h2 id="sec:create-an-api-key">Create an API key</h2>
<p>In order to deploy to <strong><code>ricochet</code></strong>, you need to create an API key. To create an API key, sign in to your ricochet server.</p>
<ul>
<li>Navigate to your <a href="https://ricochet.rs/account">account settings</a>
</li>
<li>Click the <code>API Keys</code> tab</li>
<li>Give your API key a name</li>
<li>Do not modify the API key scopes</li>
<li>Set a duration for the API key</li>
<li>Copy the API key</li>
</ul>
<p>Note that you will <strong>not be able to see your API key again</strong>. Next, set your API key to the <code>RICOCHET_API_KEY</code> environment variable. It is recommended to use the <code>.Renviron</code> file.</p>
<p>To edit your <code>.Renviron</code> file use</p>
<pre class="shiki shiki-themes github-light catppuccin-mocha" style="background-color:#fff;--shiki-dark-bg:#1e1e2e;color:#24292e;--shiki-dark:#cdd6f4" tabindex="0"><code><span class="line"><span style="color:#24292E;--shiki-dark:#CDD6F4">usethis</span><span style="color:#24292E;--shiki-dark:#94E2D5">::</span><span style="color:#24292E;--shiki-dark:#CDD6F4">edit_r_environ</span><span style="color:#24292E;--shiki-dark:#9399B2">()</span></span>
<span class="line"></span></code></pre>
<p>This will open your user level <code>.Renviron</code> file. Add the following entry:</p>
<pre class="shiki shiki-themes github-light catppuccin-mocha" style="background-color:#fff;--shiki-dark-bg:#1e1e2e;color:#24292e;--shiki-dark:#cdd6f4" tabindex="0"><code><span class="line"><span style="color:#24292E;--shiki-dark:#CDD6F4">RICOCHET_API_KEY</span><span style="color:#D73A49;--shiki-dark:#94E2D5">=</span><span style="color:#032F62;--shiki-dark:#A6E3A1">rico_BTqaQcvvWEr_CKbD8LGUwvmeeMzZiPkMKayizRANktTLL</span></span>
<span class="line"></span></code></pre>
<p>Restart your R session for the new environment variable to be registered.</p>
<h2 id="sec:install-ricochet">Install <code>{ricochet}</code>
</h2>
<p>The <code>{ricochet}</code> R package is designed to make it easy to manage your deployments.</p>
<p>Install the R package with</p>
<pre class="shiki shiki-themes github-light catppuccin-mocha" style="background-color:#fff;--shiki-dark-bg:#1e1e2e;color:#24292e;--shiki-dark:#cdd6f4" tabindex="0"><code><span class="line"><span style="color:#6A737D;font-style:inherit;--shiki-dark:#9399B2;--shiki-dark-font-style:italic"># install remotes if not present</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#CBA6F7">if</span><span style="color:#24292E;--shiki-dark:#9399B2"> (</span><span style="color:#D73A49;--shiki-dark:#94E2D5">!</span><span style="color:#005CC5;font-style:inherit;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic">requireNamespace</span><span style="color:#24292E;--shiki-dark:#9399B2">(</span><span style="color:#032F62;--shiki-dark:#A6E3A1">"remotes"</span><span style="color:#24292E;--shiki-dark:#9399B2">))</span><span style="color:#005CC5;font-style:inherit;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic"> install.packages</span><span style="color:#24292E;--shiki-dark:#9399B2">(</span><span style="color:#032F62;--shiki-dark:#A6E3A1">"remotes"</span><span style="color:#24292E;--shiki-dark:#9399B2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;font-style:inherit;--shiki-dark:#9399B2;--shiki-dark-font-style:italic"># install ricochet</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#CDD6F4">remotes</span><span style="color:#24292E;--shiki-dark:#94E2D5">::</span><span style="color:#24292E;--shiki-dark:#CDD6F4">install_url</span><span style="color:#24292E;--shiki-dark:#9399B2">(</span><span style="color:#032F62;--shiki-dark:#A6E3A1">"https://docs.ricochet.rs/pkgs/ricochet-r.tar.gz"</span><span style="color:#24292E;--shiki-dark:#9399B2">)</span></span>
<span class="line"></span></code></pre>
<p>The <code>{ricochet}</code> package automatically fetches your API key from the <code>RICOCHET_API_KEY</code> environment variable to simplify the deployment process.</p>
<h2 id="sec:create-an-api">Create an API</h2>
<p>For this quickstart, you will deploy a <a href="https://github.com/rstudio/plumber">{plumber}</a> API.</p>
<p>Create an empty project folder and set it as your working directory. Inside of the folder, create a new R script called <code>plumber.R</code> with the following body</p>
<pre class="shiki shiki-themes github-light catppuccin-mocha" style="background-color:#fff;--shiki-dark-bg:#1e1e2e;color:#24292e;--shiki-dark:#cdd6f4" tabindex="0"><code><span class="line"><span style="color:#005CC5;font-style:inherit;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic">library</span><span style="color:#24292E;--shiki-dark:#9399B2">(</span><span style="color:#24292E;--shiki-dark:#CDD6F4">plumber</span><span style="color:#24292E;--shiki-dark:#9399B2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;font-style:inherit;--shiki-dark:#9399B2;--shiki-dark-font-style:italic">#* @get /echo</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#CBA6F7">function</span><span style="color:#24292E;--shiki-dark:#9399B2">(</span><span style="color:#24292E;font-style:inherit;--shiki-dark:#EBA0AC;--shiki-dark-font-style:italic">msg </span><span style="color:#D73A49;--shiki-dark:#94E2D5">=</span><span style="color:#032F62;--shiki-dark:#A6E3A1"> ""</span><span style="color:#24292E;--shiki-dark:#9399B2">)</span><span style="color:#24292E;--shiki-dark:#9399B2"> {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#CBA6F7">  list</span><span style="color:#24292E;--shiki-dark:#9399B2">(</span><span style="color:#E36209;font-style:inherit;--shiki-dark:#EBA0AC;--shiki-dark-font-style:italic">msg</span><span style="color:#D73A49;--shiki-dark:#94E2D5"> =</span><span style="color:#005CC5;font-style:inherit;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic"> paste0</span><span style="color:#24292E;--shiki-dark:#9399B2">(</span><span style="color:#032F62;--shiki-dark:#A6E3A1">"The message is: '"</span><span style="color:#24292E;--shiki-dark:#9399B2">,</span><span style="color:#24292E;--shiki-dark:#CDD6F4"> msg</span><span style="color:#24292E;--shiki-dark:#9399B2">,</span><span style="color:#032F62;--shiki-dark:#A6E3A1"> "'"</span><span style="color:#24292E;--shiki-dark:#9399B2">))</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#9399B2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;font-style:inherit;--shiki-dark:#9399B2;--shiki-dark-font-style:italic">#* @post /sum</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#CBA6F7">function</span><span style="color:#24292E;--shiki-dark:#9399B2">(</span><span style="color:#24292E;font-style:inherit;--shiki-dark:#EBA0AC;--shiki-dark-font-style:italic">a</span><span style="color:#24292E;--shiki-dark:#9399B2">,</span><span style="color:#24292E;font-style:inherit;--shiki-dark:#EBA0AC;--shiki-dark-font-style:italic"> b</span><span style="color:#24292E;--shiki-dark:#9399B2">)</span><span style="color:#24292E;--shiki-dark:#9399B2"> {</span></span>
<span class="line"><span style="color:#005CC5;font-style:inherit;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic">  as.numeric</span><span style="color:#24292E;--shiki-dark:#9399B2">(</span><span style="color:#24292E;--shiki-dark:#CDD6F4">a</span><span style="color:#24292E;--shiki-dark:#9399B2">)</span><span style="color:#D73A49;--shiki-dark:#94E2D5"> +</span><span style="color:#005CC5;font-style:inherit;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic"> as.numeric</span><span style="color:#24292E;--shiki-dark:#9399B2">(</span><span style="color:#24292E;--shiki-dark:#CDD6F4">b</span><span style="color:#24292E;--shiki-dark:#9399B2">)</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#9399B2">}</span></span>
<span class="line"></span></code></pre>
<p>This will be the API that is deployed to <strong><code>ricochet</code></strong>.</p>
<h2 id="sec:creating-a-ricochet-toml">Creating a <code>_ricochet.toml</code>
</h2>
<p>Each R-based item that is deployed to <strong><code>ricochet</code></strong> requires an <a href="https://rstudio.github.io/renv/"><code>renv.lock</code></a> and a <a href="/ricochet-toml"><code>_ricochet.toml</code></a> file. The <code>renv.lock</code> file is used to track dependencies for your deployment item. The <code>_ricochet.toml</code> defines the type of deployment as well as associated metadata.</p>
<p>Run <code>ricochet::use_ricochet_toml()</code> to create a new <code>_ricochet.toml</code>. The function will give you a number of prompts.</p>
<ul>
<li>Name your item <code>"Plumber API"</code>. The item's name will be user facing.</li>
<li>Choose item's <a href="/access">access type</a>.</li>
<li>Select the type of the item being deployed. Press <code>1</code> for Plumber.</li>
<li>Select the <a href="/entrypoints">entrypoint</a> <code>plumber.R</code>.</li>
</ul>
<p>Additional metadata can be set in the <code>_ricochet.toml</code> file. See <a href="/ricochet-toml">Using <code>_ricochet.toml</code></a> for more details. If a <code>README.md</code> is present, it will be rendered in the content listing.</p>
<h2 id="sec:deploy">Deploy</h2>
<p>You're now ready to deploy your plumber API. Deploy your item using <code>ricochet::deploy()</code></p>
<pre class="shiki shiki-themes github-light catppuccin-mocha" style="background-color:#fff;--shiki-dark-bg:#1e1e2e;color:#24292e;--shiki-dark:#cdd6f4" tabindex="0"><code><span class="line"><span style="color:#24292E;--shiki-dark:#CDD6F4">deployment </span><span style="color:#D73A49;--shiki-dark:#94E2D5">&#x3C;-</span><span style="color:#24292E;--shiki-dark:#CDD6F4"> ricochet</span><span style="color:#24292E;--shiki-dark:#94E2D5">::</span><span style="color:#24292E;--shiki-dark:#CDD6F4">deploy</span><span style="color:#24292E;--shiki-dark:#9399B2">()</span></span>
<span class="line"></span></code></pre>
<p>Your plumber API is now being deployed. You can view the progress of your deployment on the web UI.</p>
<pre class="shiki shiki-themes github-light catppuccin-mocha" style="background-color:#fff;--shiki-dark-bg:#1e1e2e;color:#24292e;--shiki-dark:#cdd6f4" tabindex="0"><code><span class="line"><span style="color:#24292E;--shiki-dark:#CDD6F4">url </span><span style="color:#D73A49;--shiki-dark:#94E2D5">&#x3C;-</span><span style="color:#005CC5;font-style:inherit;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic"> sprintf</span><span style="color:#24292E;--shiki-dark:#9399B2">(</span></span>
<span class="line"><span style="color:#032F62;--shiki-dark:#A6E3A1">  "%s/content/%s/deployment/%s"</span><span style="color:#24292E;--shiki-dark:#9399B2">,</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#CDD6F4">  ricochet</span><span style="color:#24292E;--shiki-dark:#94E2D5">::</span><span style="color:#24292E;--shiki-dark:#CDD6F4">ricochet_host</span><span style="color:#24292E;--shiki-dark:#9399B2">(),</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#CDD6F4">  deployment</span><span style="color:#D73A49;--shiki-dark:#CBA6F7">$</span><span style="color:#24292E;--shiki-dark:#CDD6F4">id</span><span style="color:#24292E;--shiki-dark:#9399B2">,</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#CDD6F4">  deployment</span><span style="color:#D73A49;--shiki-dark:#CBA6F7">$</span><span style="color:#24292E;--shiki-dark:#CDD6F4">deployment_id</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#9399B2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#005CC5;font-style:inherit;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic">browseURL</span><span style="color:#24292E;--shiki-dark:#9399B2">(</span><span style="color:#24292E;--shiki-dark:#CDD6F4">url</span><span style="color:#24292E;--shiki-dark:#9399B2">)</span></span>
<span class="line"></span></code></pre>
<p>Once the deployment has completed you can now send a request to your plumber API.</p>
<pre class="shiki shiki-themes github-light catppuccin-mocha" style="background-color:#fff;--shiki-dark-bg:#1e1e2e;color:#24292e;--shiki-dark:#cdd6f4" tabindex="0"><code><span class="line"><span style="color:#005CC5;font-style:inherit;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic">library</span><span style="color:#24292E;--shiki-dark:#9399B2">(</span><span style="color:#24292E;--shiki-dark:#CDD6F4">httr2</span><span style="color:#24292E;--shiki-dark:#9399B2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#CDD6F4">request</span><span style="color:#24292E;--shiki-dark:#9399B2">(</span><span style="color:#24292E;--shiki-dark:#CDD6F4">ricochet</span><span style="color:#24292E;--shiki-dark:#94E2D5">::</span><span style="color:#24292E;--shiki-dark:#CDD6F4">ricochet_host</span><span style="color:#24292E;--shiki-dark:#9399B2">())</span><span style="color:#D73A49;--shiki-dark:#94E2D5"> |></span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#CDD6F4">  req_url_path_append</span><span style="color:#24292E;--shiki-dark:#9399B2">(</span><span style="color:#24292E;--shiki-dark:#CDD6F4">deployment</span><span style="color:#D73A49;--shiki-dark:#CBA6F7">$</span><span style="color:#24292E;--shiki-dark:#CDD6F4">id</span><span style="color:#24292E;--shiki-dark:#9399B2">,</span><span style="color:#032F62;--shiki-dark:#A6E3A1"> "echo"</span><span style="color:#24292E;--shiki-dark:#9399B2">)</span><span style="color:#D73A49;--shiki-dark:#94E2D5"> |></span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#CDD6F4">  req_url_query</span><span style="color:#24292E;--shiki-dark:#9399B2">(</span><span style="color:#E36209;font-style:inherit;--shiki-dark:#EBA0AC;--shiki-dark-font-style:italic">msg</span><span style="color:#D73A49;--shiki-dark:#94E2D5"> =</span><span style="color:#032F62;--shiki-dark:#A6E3A1"> "hello from ricochet!"</span><span style="color:#24292E;--shiki-dark:#9399B2">)</span><span style="color:#D73A49;--shiki-dark:#94E2D5"> |></span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#CDD6F4">  req_perform</span><span style="color:#24292E;--shiki-dark:#9399B2">()</span><span style="color:#D73A49;--shiki-dark:#94E2D5"> |></span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#CDD6F4">  resp_body_json</span><span style="color:#24292E;--shiki-dark:#9399B2">()</span></span>
<span class="line"></span></code></pre>
<pre class="shiki shiki-themes github-light catppuccin-mocha" style="background-color:#fff;--shiki-dark-bg:#1e1e2e;color:#24292e;--shiki-dark:#cdd6f4" tabindex="0"><code><span class="line"><span>#> $msg</span></span>
<span class="line"><span>#> $msg[[1]]</span></span>
<span class="line"><span>#> [1] "The message is: 'hello from ricochet!'"</span></span>
<span class="line"><span></span></span></code></pre>
</body>